<!DOCTYPE html>
<html lang="lt">
<head>
<meta charset="UTF-8">
<title>Insurance Calculator (Auto Currency)</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --bg:#eef1f5;
  --card:#ffffff;
  --text:#0f172a;
  --header:#111827;
  --header-text:#f9fafb;
  --border:#cbd5e1;
}
body.dark{
  --bg:#020617;
  --card:#0f172a;
  --text:#e5e7eb;
  --header:#000000;
  --header-text:#f9fafb;
  --border:#475569;
}

*{box-sizing:border-box;}

body{
    margin:0;
    font-family:Arial, sans-serif;
    background:var(--bg);
    color:var(--text);
}

header{
    background:var(--header);
    color:var(--header-text);
    padding:10px 16px;
    display:flex;
    align-items:center;
    gap:12px;
}
header h1{
    font-size:18px;
    margin:0;
    font-weight:700;
}
header .spacer{ flex:1; }
header button{
    padding:6px 10px;
    border:none;
    border-radius:999px;
    background:#334155;
    color:#e5e7eb;
    cursor:pointer;
    font-size:13px;
}

.container{
    max-width:1200px;
    margin:0 auto;
    padding:16px;
    display:flex;
    gap:16px;
    flex-wrap:wrap;
}

.card{
    background:var(--card);
    border-radius:12px;
    border:1px solid var(--border);
    padding:16px;
    box-shadow:0 2px 8px rgba(0,0,0,0.18);
    flex:1 1 360px;
    min-width:320px;
}

h2{
    margin:0 0 10px 0;
    font-size:18px;
}
label{
    display:block;
    font-size:12px;
    font-weight:600;
    margin-top:8px;
}

input, select, textarea{
    width:100%;
    padding:8px;
    border-radius:8px;
    border:1px solid var(--border);
    background:var(--card);
    color:var(--text);
    font-size:13px;
}

textarea{
    min-height:130px;
    resize:vertical;
    font-family:Consolas, monospace;
}

button.action{
    width:100%;
    padding:9px;
    margin-top:10px;
    border:none;
    border-radius:8px;
    background:#2563eb;
    color:white;
    font-weight:700;
    cursor:pointer;
    font-size:14px;
}
button.action:hover{ background:#1d4ed8; }

.row{ display:flex; gap:10px; }
.row > div{ flex:1; }

.value{ font-weight:700; }
.green{ color:#22c55e; }
.red{ color:#ef4444; }

/* AI≈†K≈™S CHECKBOX‚ÄôAI */
.checkbox-clean {
    display:flex;
    flex-direction:column;
    gap:6px;
    padding:10px;
    background:rgba(0,0,0,0.04);
    border-radius:8px;
    border:1px solid var(--border);
}
.checkbox-clean label {
    font-size:13px;
    font-weight:600;
    display:flex;
    align-items:center;
    gap:6px;
}
.checkbox-clean input[type="checkbox"] {
    width:16px;
    height:16px;
}

.pdf-controls{
    margin-top:12px;
    display:flex;
    gap:8px;
    align-items:center;
    font-size:12px;
}
.pdf-controls select{
    width:auto;
    min-width:140px;
}

@media print{
    body{ background:#ffffff; color:#000000; }
    header, .pdf-controls{ display:none !important; }
    .card{ box-shadow:none; border:1px solid #e5e7eb; }
    body.pdf-calcs #clientCard{ display:none !important; }
    body.pdf-client #calcCard{ display:none !important; }
    body.pdf-both #calcCard, body.pdf-both #clientCard{ display:block !important; }
}

.signature{
    text-align:center;
    color:#888;
    font-size:12px;
    margin-top:25px;
    margin-bottom:20px;
}
</style>
</head>

<body>

<header>
    <h1>Insurance Calculator (Auto Currency)</h1>
    <div class="spacer"></div>
    <button onclick="toggleDark()">üåô / ‚òÄÔ∏è</button>
</header>

<div class="container">

    <div class="card" id="calcCard">
        <h2>Skaiƒçiuoklƒó</h2>

        <label>Invoice valiuta</label>
        <select id="invoiceCurrency">
            <option>USD</option>
            <option>EUR</option>
            <option>PLN</option>
            <option>GBP</option>
            <option>CHF</option>
            <option>TRY</option>
            <option>KZT</option>
            <option>CNY</option>
            <option>CAD</option>
            <option>AUD</option>
        </select>

        <label>Invoice suma (ta valiuta)</label>
        <input type="number" id="invoiceAmount" placeholder="pvz. 625000">

        <label>Invoice suma EUR (automatiskai per ECB/LB)</label>
        <input type="number" id="invoiceEUR" readonly style="background:#e2e8f0;">

        <div class="row">
            <div>
                <label>Brokerio %</label>
                <select id="brokerPercent">
                    <option value="0.07">0,07 %</option>
                    <option value="0.08">0,08 %</option>
                    <option value="0.10">0,10 %</option>
                    <option value="0.12">0,12 %</option>
                    <option value="custom">Kitas</option>
                </select>
            </div>
            <div>
                <label>Brokerio % (jei Kitas)</label>
                <input type="text" id="brokerCustom" placeholder="pvz. 0.09" disabled>
            </div>
        </div>

        <div class="row">
            <div>
                <label>Tavo % klientui</label>
                <select id="myPercent">
                    <option value="0.23">0,23 %</option>
                    <option value="0.24" selected>0,24 %</option>
                    <option value="0.25">0,25 %</option>
                    <option value="custom">Kitas</option>
                </select>
            </div>
            <div>
                <label>Tavo % (jei Kitas)</label>
                <input type="text" id="myCustom" placeholder="pvz. 0.27" disabled>
            </div>
        </div>

        <button class="action" onclick="calc()">Skaiƒçiuoti</button>

        <h3>Rezultatai</h3>
        <p>Invoice EUR: <span id="resInvoiceEUR" class="value">‚Äì</span></p>
        <p>Savikaina (brokeris): <span id="resCost" class="value">‚Äì</span></p>
        <p>Kaina klientui: <span id="resClient" class="value">‚Äì</span></p>
        <p>Pelnas: <span id="resProfit" class="value">‚Äì</span></p>

        <h4>AON vs Legator palyginimui</h4>
        <p>AON 0,07 %: <span id="resAON" class="value">‚Äì</span></p>
        <p>Legator 0,10 %: <span id="resLeg" class="value">‚Äì</span></p>
    </div>

    <div class="card" id="clientCard">
        <h2>Tekstas klientui</h2>

        <label>Kalba / Language</label>
        <select id="lang">
            <option value="LT">Lietuvi≈≥</option>
            <option value="EN">English</option>
            <option value="RU">–†—É—Å—Å–∫–∏–π</option>
        </select>

        <label style="margin-bottom:6px; display:block; font-weight:700;">KƒÖ rodyti klientui?</label>

        <div class="checkbox-clean">
            <label><input type="checkbox" id="showEUR" checked> Rodyti kainƒÖ EUR</label>
            <label><input type="checkbox" id="showUSD" checked> Rodyti kainƒÖ USD</label>
            <label><input type="checkbox" id="showDate" checked> Rodyti datƒÖ</label>
            <label><input type="checkbox" id="showInvoice" checked> Rodyti invoice eilutƒô</label>
        </div>

        <label>Kursas EUR ‚Üí USD</label>
        <input type="number" id="rateEurUsd" step="0.0001" placeholder="pvz. 1.1550">

        <button class="action" onclick="generateClientText()">Generuoti tekstƒÖ klientui</button>

        <label>Tekstas klientui</label>
        <textarea id="clientText"></textarea>

        <button class="action" onclick="copyClientText()">Kopijuoti tekstƒÖ</button>

        <div class="pdf-controls">
            <span>PDF turinys:</span>
            <select id="pdfMode">
                <option value="both">Skaiƒçiuoklƒó + tekstas</option>
                <option value="calc">Tik skaiƒçiuoklƒó</option>
                <option value="client">Tik tekstas klientui</option>
            </select>
            <button onclick="generatePDF()" style="width:auto;padding:6px 10px;">PDF (Print)</button>
        </div>
    </div>
</div>

<script>
let lastClientEUR = null;

/* Dark mode */
function toggleDark(){
    document.body.classList.toggle("dark");
    localStorage.setItem("dark", document.body.classList.contains("dark"));
}
if(localStorage.getItem("dark")==="true") document.body.classList.add("dark");

/* Auto conversion ECB */
async function autoConvert(){
    const cur=document.getElementById("invoiceCurrency").value;
    const amt=parseFloat(document.getElementById("invoiceAmount").value);
    const out=document.getElementById("invoiceEUR");

    if(!amt){ out.value=""; return; }
    if(cur==="EUR"){ out.value=amt.toFixed(2); return; }

    try{
        const r=await fetch("https://api.frankfurter.app/latest?from="+cur+"&to=EUR");
        const d=await r.json();
        out.value=(amt*d.rates.EUR).toFixed(4);
    }catch(e){ out.value=""; }
}
document.getElementById("invoiceCurrency").addEventListener("change", autoConvert);
document.getElementById("invoiceAmount").addEventListener("input", autoConvert);

/* Persijungti procent≈≥ laukelius */
document.getElementById("brokerPercent").addEventListener("change", function () {
    const c=document.getElementById("brokerCustom");
    c.disabled = (this.value !== "custom");
    if(c.disabled) c.value="";
});
document.getElementById("myPercent").addEventListener("change", function () {
    const c=document.getElementById("myCustom");
    c.disabled = (this.value !== "custom");
    if(c.disabled) c.value="";
});

/* Skaiƒçiavimai */
function calc(){
    const eur=parseFloat(document.getElementById("invoiceEUR").value);
    if(!eur){ alert("Blogi duomenys"); return; }

    let b=document.getElementById("brokerPercent").value;
    if(b==="custom"){
        b = document.getElementById("brokerCustom").value.replace(",", ".");
        b = parseFloat(b)/100;
    } else {
        b = parseFloat(b)/100;
    }

    let m=document.getElementById("myPercent").value;
    if(m==="custom"){
        m = document.getElementById("myCustom").value.replace(",", ".");
        m = parseFloat(m)/100;
    } else {
        m = parseFloat(m)/100;
    }

    if(isNaN(b) || isNaN(m)){
        alert("ƒÆvesk procentƒÖ teisingai, pvz. 0.30");
        return;
    }

    const cost=eur*b;
    const client=eur*m;
    lastClientEUR=client;

    document.getElementById("resInvoiceEUR").textContent=eur.toFixed(2)+" EUR";
    document.getElementById("resCost").textContent=cost.toFixed(2)+" EUR";
    document.getElementById("resClient").textContent=client.toFixed(2)+" EUR";

    const p=client-cost;
    const pe=document.getElementById("resProfit");
    pe.textContent=p.toFixed(2)+" EUR";
    pe.className="value "+(p>=0?"green":"red");

    document.getElementById("resAON").textContent=(eur*0.0007).toFixed(2)+" EUR";
    document.getElementById("resLeg").textContent=(eur*0.001).toFixed(2)+" EUR";
}

/* Profesionalus LT / EN / RU tekstas klientui */
function generateClientText() {
    if (!lastClientEUR) {
        alert("Pirmiausia apskaiƒçiuok kainƒÖ");
        return;
    }

    const eur = lastClientEUR;
    const rate = parseFloat(document.getElementById("rateEurUsd").value);
    const showEUR = document.getElementById("showEUR").checked;
    const showUSD = document.getElementById("showUSD").checked;
    const showDate = document.getElementById("showDate").checked;
    const showInvoice = document.getElementById("showInvoice").checked;

    const amt = document.getElementById("invoiceAmount").value;
    const cur = document.getElementById("invoiceCurrency").value;
    const lang = document.getElementById("lang").value;

    const today = new Date().toISOString().split("T")[0];

    let out = "";

    /* ===== LT ===== */
    if (lang === "LT") {
        out += "Siunƒçiame preliminariƒÖ draudimo ƒØmokos kainƒÖ pagal pateiktƒÖ invoice vertƒô.\n\n";

        if (showEUR) out += `‚Ä¢ Draudimo kaina: ${eur.toFixed(2)} EUR\n`;
        if (showUSD) {
            if (!rate) { alert("ƒÆvesk kursƒÖ"); return; }
            out += `‚Ä¢ USD suma pagal ≈°iandienos kursƒÖ: ${(eur * rate).toFixed(2)} USD\n`;
        }
        if (showInvoice && amt) out += `‚Ä¢ Invoice vertƒó: ${amt} ${cur}\n`;
        if (showDate) out += `‚Ä¢ Data: ${today}\n`;

        out += `\nPastaba:\nTai yra orientacinƒó ƒØmoka, apskaiƒçiuota pagal invoice vertƒô ir ≈°iandienos valiutos kursƒÖ.\nGalutinƒó draudimo kaina gali skirtis, priklausomai nuo poliso i≈°ra≈°ymo dienos.\n`;
    }

    /* ===== EN ===== */
    if (lang === "EN") {
        out += "Please find below the preliminary insurance premium calculated based on the provided invoice value.\n\n";

        if (showEUR) out += `‚Ä¢ Insurance price: ${eur.toFixed(2)} EUR\n`;
        if (showUSD) {
            if (!rate) { alert("Enter FX rate"); return; }
            out += `‚Ä¢ USD amount at today‚Äôs rate: ${(eur * rate).toFixed(2)} USD\n`;
        }
        if (showInvoice && amt) out += `‚Ä¢ Invoice value: ${amt} ${cur}\n`;
        if (showDate) out += `‚Ä¢ Date: ${today}\n`;

        out += `\nNote:\nThis is an indicative premium based on the invoice value and current exchange rate.\nThe final amount may vary depending on the policy issuance date.\n`;
    }

    /* ===== RU ===== */
    if (lang === "RU") {
        out += "–ù–∏–∂–µ —É–∫–∞–∑–∞–Ω–∞ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å —Å—Ç—Ä–∞—Ö–æ–≤–æ–π –ø—Ä–µ–º–∏–∏, —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω–∞—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—É–º–º—ã –∏–Ω–≤–æ–π—Å–∞.\n\n";

        if (showEUR) out += `‚Ä¢ –°—Ç–æ–∏–º–æ—Å—Ç—å —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏: ${eur.toFixed(2)} EUR\n`;
        if (showUSD) {
            if (!rate) { alert("–í–≤–µ–¥–∏—Ç–µ –∫—É—Ä—Å"); return; }
            out += `‚Ä¢ –°—É–º–º–∞ –≤ USD –ø–æ —Ç–µ–∫—É—â–µ–º—É –∫—É—Ä—Å—É: ${(eur * rate).toFixed(2)} USD\n`;
        }
        if (showInvoice && amt) out += `‚Ä¢ –°—É–º–º–∞ –∏–Ω–≤–æ–π—Å–∞: ${amt} ${cur}\n`;
        if (showDate) out += `‚Ä¢ –î–∞—Ç–∞: ${today}\n`;

        out += `\n–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:\n–≠—Ç–æ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω–∞—è –ø—Ä–µ–º–∏—è, —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω–∞—è –ø–æ —Å—É–º–º–µ –∏–Ω–≤–æ–π—Å–∞ –∏ —Ç–µ–∫—É—â–µ–º—É –∫—É—Ä—Å—É.\n–§–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –¥–∞—Ç—ã –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –ø–æ–ª–∏—Å–∞.\n`;
    }

    document.getElementById("clientText").value = out;
}

/* Copy */
function copyClientText(){
    const t=document.getElementById("clientText");
    t.select();
    document.execCommand("copy");
}

/* PDF */
function generatePDF(){
    const m=document.getElementById("pdfMode").value;
    document.body.classList.remove("pdf-calcs","pdf-client","pdf-both");
    document.body.classList.add("pdf-"+m);
    window.print();
}
</script>

<div class="signature">¬© Donatas</div>

</body>
</html>
